Description: when Qt is built with -no-webkit and Qt WebKit is used
             Qt applications cannot found webkit as they rely on qmake. 
             Make it possible for Qt modules to extend QT_CONFIG.
             This is done by reading the module files from within qconfig.pri.
Author: Simon Hausmann <simon.hausmann@nokia.com>
Author: Fathi Boudra <fathi.boudra@nokia.com>

--- a/configure
+++ b/configure
@@ -7719,6 +7719,9 @@ QT_LIBINFIX = $QT_LIBINFIX
 QT_NAMESPACE = $QT_NAMESPACE
 QT_NAMESPACE_MAC_CRC = $QT_NAMESPACE_MAC_CRC
 
+#modules
+for(mod,\$\$list(\$\$files(\$\$[QMAKE_MKSPECS]/modules/qt_*.pri))):include(\$\$mod)
+
 EOF
 if [ "$CFG_RPATH" = "yes" ]; then
     echo "QMAKE_RPATHDIR += \"$QT_INSTALL_LIBS\"" >> "$QTCONFIG.tmp"
--- a/mkspecs/modules/qt_webkit_version.pri
+++ b/mkspecs/modules/qt_webkit_version.pri
@@ -1,3 +1,7 @@
+#configuration
+QT_CONFIG *= webkit
+
+#versioning
 QT_WEBKIT_VERSION = 4.7.0
 QT_WEBKIT_MAJOR_VERSION = 4
 QT_WEBKIT_MINOR_VERSION = 7
--- a/tools/configure/configureapp.cpp
+++ b/tools/configure/configureapp.cpp
@@ -2925,6 +2925,8 @@ void Configure::generateCachefile()
             configStream << "#namespaces" << endl << "QT_NAMESPACE = " << dictionary["QT_NAMESPACE"] << endl;
         }
 
+        configStream << "#modules" << endl << "for(mod,$$list($$files($$[QMAKE_MKSPECS]/modules/qt_*.pri))):include($$mod)" << endl;
+
         configStream.flush();
         configFile.close();
     }
