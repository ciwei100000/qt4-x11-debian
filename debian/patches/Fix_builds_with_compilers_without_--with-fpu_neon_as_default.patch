commit bc21d7604c78cf05780bb9974911ba81e787b6f9
Author: Robin Burchell <robin.burchell@collabora.co.uk>
Date:   Fri Feb 4 12:39:51 2011 +0100

    Fix builds with compilers without --with-fpu=neon as a default.

    The changes introduced in fac68dca46131d63f11c37210834073848f5a93d do not work
    correctly on compilers without --with-fpu=neon as a default, NEON_SOURCES would
    be (incorrectly) compiled without -mfpu=neon, resulting in build failure.

    This also moves -mfpu=neon after CXXFLAGS, as CXXFLAGS may contain
    -mfpu=vfpv3-d16.

    Issue noted by Carsten Munk while building Qt for MeeGo ARM with NEON.

    Merge-request: 1042
    Reviewed-by: Samuel RÃ¸dal <samuel.rodal@nokia.com>

---
 src/gui/gui.pro |    7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

--- a/src/gui/gui.pro
+++ b/src/gui/gui.pro
@@ -65,15 +65,14 @@ symbian {
 neon:*-g++* {
     DEFINES += QT_HAVE_NEON
     HEADERS += $$NEON_HEADERS
-    SOURCES += $$NEON_SOURCES
 
     DRAWHELPER_NEON_ASM_FILES = $$NEON_ASM
 
-    neon_compiler.commands = $$QMAKE_CXX -c -mfpu=neon
-    neon_compiler.commands += $(CXXFLAGS) $(INCPATH) ${QMAKE_FILE_IN} -o ${QMAKE_FILE_OUT}
+    neon_compiler.commands = $$QMAKE_CXX -c
+    neon_compiler.commands += $(CXXFLAGS) -mfpu=neon $(INCPATH) ${QMAKE_FILE_IN} -o ${QMAKE_FILE_OUT}
     neon_compiler.dependency_type = TYPE_C
     neon_compiler.output = ${QMAKE_VAR_OBJECTS_DIR}${QMAKE_FILE_BASE}$${first(QMAKE_EXT_OBJ)}
-    neon_compiler.input = DRAWHELPER_NEON_ASM_FILES
+    neon_compiler.input = DRAWHELPER_NEON_ASM_FILES NEON_SOURCES
     neon_compiler.variable_out = OBJECTS
     neon_compiler.name = compiling[neon] ${QMAKE_FILE_IN}
     silent:neon_compiler.commands = @echo compiling[neon] ${QMAKE_FILE_IN} && $$neon_compiler.commands
